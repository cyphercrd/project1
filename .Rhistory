# we can also see which days had the highest difference in volume and which days had the lowest
joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(absDiffVolume)
joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(desc(absDiffVolume))
# lowest difference on 2009-09-24 highest on 2007-04-25
# we can use regex to find the number of data points in 2004 and compare it to the number
# of data points in 2021 (the extremes of Date)
joinData$Date %>% str_detect("2004-.+") %>% sum()
joinData$Date %>% str_detect("2021-.+") %>% sum()
# summary statistics
joinData %>% summarize(mean(Open.goog))
joinData %>% summarize(mean(Open.amzn))
joinData %>% summarize(max(High.goog))
joinData %>% summarize(max(High.amzn))
joinData %>% summarize(min(Low.goog))
joinData %>% summarize(min(Low.amzn))
# defining function that computes range
range = function(x) {max(x) - min(x)}
joinData %>% summarize(range(Close.goog))
joinData %>% summarize(range(Close.amzn))
joinData %>% summarize(sd(`Adj Close.goog`))
joinData %>% summarize(sd(`Adj Close.amzn`))
# dichotimizing Volume
joinData %>% summarize(median(Volume.goog))
chrVolumeGoog = joinData %>% select(Volume.goog) %>% apply(MARGIN=1,FUN=function(x) {ifelse(x>3857405,"high","low")})
joinData %>% mutate(chrVolumeGoog = chrVolumeGoog) %>% group_by(chrVolumeGoog) %>% summarize(n=n())
# number of missing values for each variable
joinData %>% summarize_all(function(x) sum(is.na(x)))
joinData %>% mutate(chrVolumeGoog = chrVolumeGoog) %>% group_by(chrVolumeGoog) %>% summarize(n=n())
glimpse(joinData)
joinData %>% group_by(chrVolumeGoog) %>% summarize(max(High.goog))
# creates a new column 'diffVolume' that computes the daily difference in trading volume between the two companies.
# note that diffVolume > 0 when Volume.goog > Volume.amzn and diffVolume < 0 when Volume.goog < Volume.amzn
joinData = joinData %>% mutate(diffVolume = Volume.goog - Volume.amzn)
# we can manipulate this to find the days when goog had a higher volume than amzn or vice-versa
joinData %>% filter(diffVolume > 0) %>% dim
joinData %>% filter(diffVolume < 0) %>% dim
# we can see that, from 2004-08-19 to 2021-09-29, there are 1730 days when goog had a higher
# volume than amzn and there are 2579 days where amzn had a higher volume than goog
# we can also see which days had the highest difference in volume and which days had the lowest
joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(absDiffVolume)
joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(desc(absDiffVolume))
# lowest difference on 2009-09-24 highest on 2007-04-25
# we can use regex to find the number of data points in 2004 and compare it to the number
# of data points in 2021 (the extremes of Date)
joinData$Date %>% str_detect("2004-.+") %>% sum()
joinData$Date %>% str_detect("2021-.+") %>% sum()
# dichotimizing Volume
joinData %>% summarize(median(Volume.goog))
chrVolumeGoog = joinData %>% select(Volume.goog) %>% apply(MARGIN=1,FUN=function(x) {ifelse(x>3857405,"high","low")})
joinData %>% mutate(chrVolumeGoog = chrVolumeGoog) %>% group_by(chrVolumeGoog) %>% summarize(n=n())
# summary statistics
joinData %>% summarize(mean(Open.goog))
joinData %>% summarize(mean(Open.amzn))
joinData %>% group_by(chrVolumeGoog) %>% summarize(max(High.goog))
# creates a new column 'diffVolume' that computes the daily difference in trading volume between the two companies.
# note that diffVolume > 0 when Volume.goog > Volume.amzn and diffVolume < 0 when Volume.goog < Volume.amzn
joinData = joinData %>% mutate(diffVolume = Volume.goog - Volume.amzn)
# we can manipulate this to find the days when goog had a higher volume than amzn or vice-versa
joinData %>% filter(diffVolume > 0) %>% dim
joinData %>% filter(diffVolume < 0) %>% dim
# we can see that, from 2004-08-19 to 2021-09-29, there are 1730 days when goog had a higher
# volume than amzn and there are 2579 days where amzn had a higher volume than goog
# we can also see which days had the highest difference in volume and which days had the lowest
joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(absDiffVolume)
joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(desc(absDiffVolume))
# lowest difference on 2009-09-24 highest on 2007-04-25
# we can use regex to find the number of data points in 2004 and compare it to the number
# of data points in 2021 (the extremes of Date)
joinData$Date %>% str_detect("2004-.+") %>% sum()
joinData$Date %>% str_detect("2021-.+") %>% sum()
# dichotimizing Volume
joinData %>% summarize(median(Volume.goog))
chrVolumeGoog = joinData %>% select(Volume.goog) %>% apply(MARGIN=1,FUN=function(x) {ifelse(x>3857405,"high","low")})
joinData = joinData %>% mutate(chrVolumeGoog = chrVolumeGoog)
joinData %>% group_by(chrVolumeGoog) %>% summarize(n=n())
# summary statistics
joinData %>% summarize(mean(Open.goog))
joinData %>% summarize(mean(Open.amzn))
joinData %>% group_by(chrVolumeGoog) %>% summarize(max(High.goog))
joinData %>% group_by(chrVolumeGoog) %>% summarize(max(High.amzn))
joinData %>% group_by(chrVolumeGoog) %>% summarize(min(Low.goog))
joinData %>% group_by(chrVolumeGoog) %>% summarize(min(Low.amzn))
# defining function that computes range
range = function(x) {max(x) - min(x)}
joinData %>% summarize(range(Close.goog))
joinData %>% summarize(range(Close.amzn))
joinData %>% summarize(sd(`Adj Close.goog`))
joinData %>% summarize(sd(`Adj Close.amzn`))
# number of missing values for each variable
joinData %>% summarize_all(function(x) sum(is.na(x)))
joinData %>% group_by(chrVolumeGoog) %>% summarize(max(High.goog))
joinData %>% group_by(chrVolumeGoog) %>% summarize(max(High.amzn))
joinData %>% group_by(chrVolumeGoog) %>% summarize(min(Low.goog))
joinData %>% group_by(chrVolumeGoog) %>% summarize(min(Low.amzn))
joinData %>% group_by(chrVolumeGoog) %>% summarize(max(High.goog)) %>% table
# summary statistics
joinData %>% summarize(mean(Open.goog)) %>% table
# summary statistics
joinData %>% summarize(mean(Open.goog))
# summary statistics
joinData %>% summarize(mean(Open.goog))
joinData %>% summarize(mean(Open.amzn))
joinData %>% summarize(mean(Open.amzn)) %>% table
# number of missing values for each variable
joinData %>% summarize_all(function(x) sum(is.na(x)))
table(joinData %>% summarize(mean(Open.goog)) ,joinData %>% summarize(mean(Open.amzn)) )
joinData %>% summarize(mean(Open.goog),mean(Open.amzn)) %>% table
joinData %>% summarize(mean(Open.goog),mean(Open.amzn)) %>% table %>% gt
joinData %>% summarize(mean(Open.goog),mean(Open.amzn)) %>% table %>% kable
# dichotimizing Date
joinData %>% str_replace(Date,"2004.+","2004")
?str_replace
# dichotimizing Date
joinData %>% str_replace(Date,"2004.+","2004")
# dichotimizing Date
joinData %>% str_replace(Date,"2004.+","yeah")
# dichotimizing Date
joinData %>% str_replace("2004.+","2004")
# dichotimizing Date
joinData %>% select(Date) %>% str_replace("2004.+","2004")
# dichotimizing Date
joinData$Date %>% str_replace("2004.+","2004")
# dichotimizing Date
joinData$Date %>% str_replace("2004.+","2004") %>% str_replace("2005.+","2005") %>% str_replace("2006.+","2006") %>% str_replace("2007.+","2007") %>% str_replace("2008.+","2008") %>% str_replace("2009.+","2009") %>% str_replace("2010.+","2010") %>% str_replace("2011.+","2011") %>% str_replace("2012.+","2012") %>% str_replace("2013.+","2013") %>% str_replace("2014.+","2014") %>% str_replace("2015.+","2015") %>% str_replace("2016.+","2016") %>% str_replace("2017.+","2017") %>% str_replace("2018.+","2018") %>% str_replace("2019.+","2019") %>% str_replace("2020.+","2020") %>% str_replace("2021.+","2021")
# dichotimizing Date
year = joinData$Date %>% str_replace("2004.+","2004") %>% str_replace("2005.+","2005") %>% str_replace("2006.+","2006") %>% str_replace("2007.+","2007") %>% str_replace("2008.+","2008") %>% str_replace("2009.+","2009") %>% str_replace("2010.+","2010") %>% str_replace("2011.+","2011") %>% str_replace("2012.+","2012") %>% str_replace("2013.+","2013") %>% str_replace("2014.+","2014") %>% str_replace("2015.+","2015") %>% str_replace("2016.+","2016") %>% str_replace("2017.+","2017") %>% str_replace("2018.+","2018") %>% str_replace("2019.+","2019") %>% str_replace("2020.+","2020") %>% str_replace("2021.+","2021")
year = joinData$Date %>% str_replace("2004.+","2004") %>% str_replace("2005.+","2005") %>% str_replace("2006.+","2006") %>% str_replace("2007.+","2007") %>% str_replace("2008.+","2008") %>% str_replace("2009.+","2009") %>% str_replace("2010.+","2010") %>% str_replace("2011.+","2011") %>% str_replace("2012.+","2012") %>% str_replace("2013.+","2013") %>% str_replace("2014.+","2014") %>% str_replace("2015.+","2015") %>% str_replace("2016.+","2016") %>% str_replace("2017.+","2017") %>% str_replace("2018.+","2018") %>% str_replace("2019.+","2019") %>% str_replace("2020.+","2020") %>% str_replace("2021.+","2021")
joinData = joinData %>% mutate(year=year)
joinData %>% group_by(year) %>% summarize(n=n())
# checking start and end dates of goog
goog %>% arrange(Date)
goog %>% arrange(desc(Date))
# checking start and end dates of amzn
amzn %>% arrange(Date)
amzn %>% arrange(desc(Date))
# checking number of dates in each dataset
goog %>% summarize(n_distinct(Date))
amzn %>% summarize(n_distinct(Date))
# checking which variables appear in one dataset but not the other
anti_join(goog,amzn,by="Date")
anti_join(amzn,goog,by="Date")
anti_join(amzn,goog,by="Date") %>% arrange(desc(Date))
# joining with inner join
joinData = inner_join(goog,amzn,by="Date",suffix=c(".goog",".amzn"))
joinData
# checking dates in common
joinData %>% arrange(Date)
joinData %>% arrange(desc(Date))
# creates a new column 'diffVolume' that computes the daily difference in trading volume between the two companies.
# note that diffVolume > 0 when Volume.goog > Volume.amzn and diffVolume < 0 when Volume.goog < Volume.amzn
joinData = joinData %>% mutate(diffVolume = Volume.goog - Volume.amzn)
# creates a new column 'diffVolume' that computes the daily difference in trading volume between the two companies.
# note that diffVolume > 0 when Volume.goog > Volume.amzn and diffVolume < 0 when Volume.goog < Volume.amzn
joinData = joinData %>% mutate(diffVolume = Volume.goog - Volume.amzn)
glimpse(joinData)
year = joinData$Date %>% str_replace("2004.+","2004") %>% str_replace("2005.+","2005") %>% str_replace("2006.+","2006") %>% str_replace("2007.+","2007") %>% str_replace("2008.+","2008") %>% str_replace("2009.+","2009") %>% str_replace("2010.+","2010") %>% str_replace("2011.+","2011") %>% str_replace("2012.+","2012") %>% str_replace("2013.+","2013") %>% str_replace("2014.+","2014") %>% str_replace("2015.+","2015") %>% str_replace("2016.+","2016") %>% str_replace("2017.+","2017") %>% str_replace("2018.+","2018") %>% str_replace("2019.+","2019") %>% str_replace("2020.+","2020") %>% str_replace("2021.+","2021")
joinData = joinData %>% mutate(year=year)
joinData %>% group_by(year) %>% summarize(n=n())
# defining function that computes range
range = function(x) {max(x) - min(x)}
joinData %>% group_by(cyl) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat")) %>% pivot_wider() -> table1
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat")) %>% pivot_wider() -> table1
table1
joinData %>% group_by(year)
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range))
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1)
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"))
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1)
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_")
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider()
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table1
table1
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
table2
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range))
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table1
table1
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
table2
# summary statistics
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table1
table1
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) -> table2
table2
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) -> table1
table1
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
table2
library(gt)
table2 %>% gt
# creates a new column 'diffVolume' that computes the daily difference in trading volume between the two companies.
# note that diffVolume > 0 when Volume.goog > Volume.amzn and diffVolume < 0 when Volume.goog < Volume.amzn
joinData = joinData %>% mutate(diffVolume = Volume.goog - Volume.amzn)
# we can manipulate this to find the days when goog had a higher volume than amzn or vice-versa
joinData %>% filter(diffVolume > 0) %>% dim
joinData %>% filter(diffVolume < 0) %>% dim
# we can see that, from 2004-08-19 to 2021-09-29, there are 1730 days when goog had a higher
# volume than amzn and there are 2579 days where amzn had a higher volume than goog
# we can also see which days had the highest difference in volume and which days had the lowest
joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(absDiffVolume)
joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(desc(absDiffVolume))
# lowest difference on 2009-09-24 highest on 2007-04-25
# dichotimizing Date
year = joinData$Date %>% str_replace("2004.+","2004") %>% str_replace("2005.+","2005") %>% str_replace("2006.+","2006") %>% str_replace("2007.+","2007") %>% str_replace("2008.+","2008") %>% str_replace("2009.+","2009") %>% str_replace("2010.+","2010") %>% str_replace("2011.+","2011") %>% str_replace("2012.+","2012") %>% str_replace("2013.+","2013") %>% str_replace("2014.+","2014") %>% str_replace("2015.+","2015") %>% str_replace("2016.+","2016") %>% str_replace("2017.+","2017") %>% str_replace("2018.+","2018") %>% str_replace("2019.+","2019") %>% str_replace("2020.+","2020") %>% str_replace("2021.+","2021")
joinData = joinData %>% mutate(year=year)
# table of counts for categorical variable
joinData %>% group_by(year) %>% summarize(n=n())
# defining function that computes range
range = function(x) {max(x) - min(x)}
# summary statistics
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) -> table1
table1 %>% gt
joinData %>% group_by(year) %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
table2 %>% gt
# number of missing values for each variable
joinData %>% summarize_all(function(x) sum(is.na(x)))
# table of counts for categorical variable
joinData %>% group_by(year) %>% summarize(n=n())
glimpse(joinData)
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point()
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_abline()
?geom_abline
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_line()
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm')
joinData %>% ggplot(aes(x=Volume.goog,y=Volume.amzn)) + geom_point() + geom_smooth(method='lm')
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm')
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_point() + geom_smooth(method='lm')
joinData %>% ggplot(aes(x=Date,y=diffVolume)) + geom_point() + geom_smooth(method='lm')
joinData %>% ggplot(aes(x=Volume.goog,y=Volume.amzn)) + geom_bar(stat="summary",fun=mean)
joinData %>% ggplot(aes(x=year,y=Volume.amzn)) + geom_bar(stat="summary",fun=mean)
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean)
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se)
joinData %>% ggplot(aes(x=Date,y=diffVolume)) + geom_density2d()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_boxplot()+ geom_jitter(alpha=.8)
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_boxplot()
joinData %>% pivot_wider(values_from=c(Open.goog,Open.amzn))
glimpse$joinData
# note: had to wrangle a little to create grouped box plot
joinData %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "yes",values_to="no")
# note: had to wrangle a little to create grouped box plot
joinData %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "name",values_to="open") %>% select(name,open)
# note: had to wrangle a little to create grouped box plot
joinData %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open) %>% str_replace(name,"Open","")
# note: had to wrangle a little to create grouped box plot
joinData %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open) %>% str_replace("Open","")
# note: had to wrangle a little to create grouped box plot
test = joinData %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
test$ticker = str_replace(test$ticker,"Open.","")
test
# note: had to wrangle a little to create grouped box plot
open = joinData %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(test$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + geom_boxplot()
ggplot(aes(x=Open.goog,y=Close.goog)) + geom_point()
joinData %>% ggplot(aes(x=Open.goog,y=Close.goog)) + geom_point()
joinData %>% ggplot(aes(x=Open.amzn,y=Close.amzn)) + geom_point()
open %>% scale %>% ggplot(aes(x=ticker,y=open)) + geom_boxplot()
open %>% ggplot(aes(x=ticker,y=open)) + geom_boxplot()
open %>% ggplot(aes(x=ticker,y=open)) + geom_boxplot() + stat_boxplot()
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot() + geom_boxplot()
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot()
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2008") + pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(test$ticker,"Open.","")
open
open
joinData %>% filter(year=="2008")
oinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open")
joinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open")
open = joinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(test$ticker,"Open.","")
open$ticker
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot()
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter()
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("hello")
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon") + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)")
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon From 2004 to 2021") + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)")
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon From 2004 to 2021",) + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)") + scale_y_continuous(breaks = seq(0,5000,500)) + scale_x_continuous(breaks = seq(0,5000,500))
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon From 2004 to 2021",) + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)") + scale_y_continuous(breaks = seq(0,5000,500)) + scale_x_continuous(breaks = seq(0,5000,500)) + theme(plot.title.position = c(.9,.8))
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon From 2004 to 2021",) + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)") + scale_y_continuous(breaks = seq(0,5000,500)) + scale_x_continuous(breaks = seq(0,5000,500))
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon From 2004 to 2021",) + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)") + scale_y_continuous(breaks = seq(0,5000,500)) + scale_x_continuous(breaks = seq(0,5000,500)) + theme_dark()
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon From 2004 to 2021",) + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)") + scale_y_continuous(breaks = seq(0,5000,500)) + scale_x_continuous(breaks = seq(0,5000,500)) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(-1e-7,2e7,500)) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(-1e-7,2e7,500000)) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(-1e-7,2e7,5e6)) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(-2e-7,2e7,5e6)) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(-1e-7,2e7,5e6)) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(0,2e7,5e6)) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(0,2e7,5e6)) + abline() + theme_minimal()
?abline
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(0,2e7,5e6)) + geom_hline() + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(0,2e7,5e6)) + geom_hline(yintercept=0) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(-2e7,2e7,2.5e6)) + geom_hline(yintercept=0) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(-2e7,2e7,1.25e6)) + geom_hline(yintercept=0) + theme_minimal()
joinData %>% ggplot(aes(x=year,y=diffVolume)) + geom_bar(stat="summary",fun=mean) + geom_errorbar(stat="summary", fun.data=mean_se) + scale_y_continuous(breaks = seq(-2e7,2e7,1.25e6)) + geom_hline(yintercept=0) + theme_minimal() + ggtitle("Differences in AMZN and GOOG Trading Volume per Year") + ylab("Difference in Trading Volume (Numbers of Shares)") + xlab("Year")
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.5)
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2)
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of AMZN vs. GOOG in 2008") + ylab("Opening Price ($)") + xlab("Ticker Symbol")
joinData %>% filter(year=="2008") %>% select(Open.goog,Open.amzn)
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2008") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of AMZN vs. GOOG in 2008") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(0,400,50)) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of AMZN vs. GOOG in 2008") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(0,400,50)) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of AMZN vs. GOOG in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(0,1500,500)) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of AMZN vs. GOOG in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol")  + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of AMZN vs. GOOG in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(700,1300,200)) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of AMZN vs. GOOG in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(700,1300,100)) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of AMZN vs. GOOG in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(700,1300,50)) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of Amazon vs. Google in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(700,1300,50)) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of Amazon vs. Google in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(700,1300,50)) + scale_x_continuous(labels=c("Amazon","Google") + theme_minimal()
?scale_x_continuous
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of Amazon vs. Google in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(700,1300,50)) + scale_x_continuous(labels=c("Amazon","Google")) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of Amazon vs. Google in 2017") + ylab("Opening Price ($)") + xlab("Ticker Symbol") + scale_y_continuous(breaks=seq(700,1300,50)) + scale_x_discrete(labels=c("Amazon","Google")) + theme_minimal()
# note: had to wrangle a little to create grouped box plot
open = joinData %>% filter(year=="2017") %>% pivot_longer(c(Open.goog,Open.amzn),names_to = "ticker",values_to="open") %>% select(ticker,open)
open$ticker = str_replace(open$ticker,"Open.","")
open %>% ggplot(aes(x=ticker,y=open)) + stat_boxplot(geom='errorbar') + geom_boxplot() + geom_jitter(alpha=0.2) + ggtitle("Opening Prices of Amazon vs. Google in 2017") + ylab("Opening Price ($)") + xlab("") + scale_y_continuous(breaks=seq(700,1300,50)) + scale_x_discrete(labels=c("Amazon","Google")) + theme_minimal()
googUntidy %>% select(1:500)
googUntidy %>% head
googRetidy %>% head
# checking start and end dates of goog
# goog %>% arrange(Date)
# goog %>% arrange(desc(Date))
# checking start and end dates of amzn
# amzn %>% arrange(Date)
# amzn %>% arrange(desc(Date))
# checking number of dates in each dataset
# goog %>% summarize(n_distinct(Date))
# amzn %>% summarize(n_distinct(Date))
# checking which variables appear in one dataset but not the other
# anti_join(goog,amzn,by="Date")
# anti_join(amzn,goog,by="Date")
# anti_join(amzn,goog,by="Date") %>% arrange(desc(Date))
# joining with inner join
joinData = inner_join(goog,amzn,by="Date",suffix=c(".goog",".amzn"))
joinData %>% head
# checking dates in common
# joinData %>% arrange(Date)
# joinData %>% arrange(desc(Date))
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon From 2004 to 2021",) + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)") + scale_y_continuous(breaks = seq(0,5000,500))  + theme_minimal()
joinData %>% ggplot(aes(x=Open.goog,y=Open.amzn)) + geom_point() + geom_smooth(method='lm') + ggtitle("Opening Prices of Google vs. Amazon From 2004 to 2021",) + xlab("Google Opening Price ($)") + ylab("Amazon Opening Price ($)") + scale_y_continuous(breaks = seq(0,5000,500)) + scale_x_continuous(breaks = seq(0,5000,500)) + theme_minimal()
table1 %>% gt
table1
# summary statistics
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer() -> table1
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range))
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) -> table1
table1
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) %>% separate(name,into=c("name","stat"),sep="_") %>% group_by(stat)-> table1
table1
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company"),sep=.) %>% group_by(stat,variable)-> table1
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) %>% separate(name,into=c("name","stat"),sep="_")
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company"))
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) %>% group_by(stat,variable)-> table1
table1
joinData %>% summarize_at(2:13, .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) %>% group_by(variable,stat)-> table1
table1
glimpse(joinData)
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) %>% group_by(variable,stat)-> table1
joinData %>% summarize_at(c(2,3,4,5,7,8,9,10,11), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:60) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) %>% group_by(variable,stat)-> table1
joinData %>% summarize_at(c(2,3,4,5,7,8,9,10,11), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range))
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range))
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) %>% group_by(variable,stat)-> table1
table1 %>% gt
joinData %>% group_by(year) %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) %>% group_by(variable,stat)-> table1
table1 %>% gt
table1
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) %>% group_by(variable,stat,company)-> table1
table1
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) %>% group_by(variable)-> table1
table1
joinData %>% group_by(year) %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
oinData %>% group_by(year)
year = joinData$Date %>% str_replace("2004.+","2004") %>% str_replace("2005.+","2005") %>% str_replace("2006.+","2006") %>% str_replace("2007.+","2007") %>% str_replace("2008.+","2008") %>% str_replace("2009.+","2009") %>% str_replace("2010.+","2010") %>% str_replace("2011.+","2011") %>% str_replace("2012.+","2012") %>% str_replace("2013.+","2013") %>% str_replace("2014.+","2014") %>% str_replace("2015.+","2015") %>% str_replace("2016.+","2016") %>% str_replace("2017.+","2017") %>% str_replace("2018.+","2018") %>% str_replace("2019.+","2019") %>% str_replace("2020.+","2020") %>% str_replace("2021.+","2021")
joinData = joinData %>% mutate(year=year)
joinData %>% group_by(year) %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
table2 %>% gt
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% pivot_wider() -> table1
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% pivot_wider()
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company"))
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range))
glimpse(joinData)
library(tidyverse)
library(gt)
goog <- read_csv("~/Documents/Fall 2021/SDS322E/project1/google.csv")
amzn <- read_csv("~/Documents/Fall 2021/SDS322E/project1/Amazon.csv")
# Datasets are tidy already. Untidying goog dataset
googUntidy = goog %>% pivot_wider(names_from="Date",values_from="Open")
googUntidy %>% head
# retidying goog dataset
googRetidy = googUntidy %>% pivot_longer(cols=6:4316,names_to="Date",values_to="Open",values_drop_na = T) %>% select(Date,Open,everything())
googRetidy %>% head
# checking start and end dates of goog
# goog %>% arrange(Date)
# goog %>% arrange(desc(Date))
# checking start and end dates of amzn
# amzn %>% arrange(Date)
# amzn %>% arrange(desc(Date))
# checking number of dates in each dataset
# goog %>% summarize(n_distinct(Date))
# amzn %>% summarize(n_distinct(Date))
# checking which variables appear in one dataset but not the other
# anti_join(goog,amzn,by="Date")
# anti_join(amzn,goog,by="Date")
# anti_join(amzn,goog,by="Date") %>% arrange(desc(Date))
# joining with inner join
joinData = inner_join(goog,amzn,by="Date",suffix=c(".goog",".amzn"))
joinData %>% head
# checking dates in common
# joinData %>% arrange(Date)
# joinData %>% arrange(desc(Date))
# creates a new column 'diffVolume' that computes the daily difference in trading volume between the two companies.
# note that diffVolume > 0 when Volume.goog > Volume.amzn and diffVolume < 0 when Volume.goog < Volume.amzn
joinData = joinData %>% mutate(diffVolume = Volume.goog - Volume.amzn)
# we can manipulate this to find the days when goog had a higher volume than amzn or vice-versa
# joinData %>% filter(diffVolume > 0) %>% dim
# joinData %>% filter(diffVolume < 0) %>% dim
# we can see that, from 2004-08-19 to 2021-09-29, there are 1730 days when goog had a higher
# volume than amzn and there are 2579 days where amzn had a higher volume than goog
# we can also see which days had the highest difference in volume and which days had the lowest
# joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(absDiffVolume)
# joinData %>% mutate(absDiffVolume = abs(diffVolume)) %>% select(Date,absDiffVolume) %>% arrange(desc(absDiffVolume))
# lowest difference on 2009-09-24 highest on 2007-04-25
# dichotimizing Date
year = joinData$Date %>% str_replace("2004.+","2004") %>% str_replace("2005.+","2005") %>% str_replace("2006.+","2006") %>% str_replace("2007.+","2007") %>% str_replace("2008.+","2008") %>% str_replace("2009.+","2009") %>% str_replace("2010.+","2010") %>% str_replace("2011.+","2011") %>% str_replace("2012.+","2012") %>% str_replace("2013.+","2013") %>% str_replace("2014.+","2014") %>% str_replace("2015.+","2015") %>% str_replace("2016.+","2016") %>% str_replace("2017.+","2017") %>% str_replace("2018.+","2018") %>% str_replace("2019.+","2019") %>% str_replace("2020.+","2020") %>% str_replace("2021.+","2021")
joinData = joinData %>% mutate(year=year)
# counts for categorical variable
# joinData %>% group_by(year) %>% summarize(n=n())
# defining function that computes range
range = function(x) {max(x) - min(x)}
# summary statistics
joinData %>% summarize_at(c(-1,-6,-12), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) -> table1
glimpse(joinData)
joinData %>% summarize_at(c(-1,-6,-12,-14,-15), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","company")) -> table1
table1
joinData %>% group_by(year) %>% summarize_at(c(-1,-6,-12,-14,-15), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
table2 %>% gt
joinData %>% summarize_at(c(-1,-6,-12,-14,-15), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","ticker")) mutate_if(is.numeric, round, 5) -> table1
joinData %>% summarize_at(c(-1,-6,-12,-14,-15), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","ticker")) %>% mutate_if(is.numeric, round, 5) -> table1
table1
joinData %>% summarize_at(c(-1,-6,-12,-14,-15), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>% pivot_longer(1:50) %>% separate(name,into=c("name","stat"),sep="_") %>% separate(name,into=c("variable","ticker")) -> table1
table1
joinData %>% group_by(year) %>% summarize_at(c(-1,-6,-12,-14,-15), .funs=list(mean=mean,sd=sd,max=max,min=min,range=range)) %>%
pivot_longer(-1) %>% separate(name, into=c("name","stat"),sep="_") %>% pivot_wider() -> table2
table2 %>% gt
table1 %>% gt
setwd("~/Documents/Fall 2021/SDS322E/project1")
